<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Daily Cashier</title>

<style>
/* ====== BASE ====== */
:root{
  --bg:#0f141c;
  --card:#181f2b;
  --line:#2a3344;
  --text:#eaf0ff;
  --muted:#9fb0c7;
  --accent:#4da3ff;
  --ok:#28d17c;
  --warn:#ffb020;
  --danger:#ff5b6e;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
}
button{font:inherit;color:inherit}

/* ====== LAYOUT ====== */
.wrap{max-width:980px;margin:auto;padding:12px 12px 120px}
.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:18px;
  padding:12px;
  margin-top:12px;
}
.row{display:flex;gap:8px;align-items:center}
.between{justify-content:space-between}
.hidden{display:none}

/* ====== HEADER ====== */
#shopName{
  font-size:26px;
  font-weight:900;
}
.sub{color:var(--muted);font-size:13px}

/* ====== TABLES ====== */
.tables{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:10px;
}
@media(min-width:600px){
  .tables{grid-template-columns:repeat(4,1fr)}
}
.tableBtn{
  height:72px;
  border-radius:16px;
  border:2px solid var(--line);
  background:#121826;
  font-weight:900;
}
.tableBtn.clean{border-color:var(--ok)}
.tableBtn.open{border-color:var(--accent)}
.tableBtn.pending{border-color:var(--danger)}

/* ====== QUICK BAR ====== */
.quickBar{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:8px;
}
.quickBtn{
  height:64px;
  border-radius:14px;
  border:1px solid var(--line);
  background:#121826;
  font-weight:900;
}
.quickBtn span{display:block;font-size:13px;color:var(--muted)}

/* ====== CATEGORIES ====== */
.cats{display:grid;grid-template-columns:repeat(4,1fr);gap:6px}
.catBtn{
  height:42px;
  border-radius:12px;
  border:1px solid var(--line);
  background:#101624;
  font-weight:800;
}
.catBtn.active{border-color:var(--accent)}

/* ====== PRODUCTS ====== */
.products{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:8px;
}
.prodBtn{
  height:60px;
  border-radius:14px;
  border:1px solid var(--line);
  background:#101624;
  font-weight:900;
}
.prodBtn span{display:block;font-size:13px;color:var(--muted)}

/* ====== TICKET ====== */
.ticketLines{
  max-height:220px;
  overflow:auto;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.line{
  background:#101624;
  border:1px solid var(--line);
  border-radius:12px;
  padding:8px;
  display:flex;
  justify-content:space-between;
}

/* ====== BOTTOM ====== */
.bottom{
  position:fixed;
  left:0;right:0;bottom:0;
  background:#0f141c;
  border-top:1px solid var(--line);
  padding:10px;
}
.bottom .row{max-width:980px;margin:auto}

/* ====== MODAL ====== */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:flex-end;
}
.modal.show{display:flex}
.sheet{
  background:var(--card);
  width:100%;
  max-height:85%;
  border-radius:20px 20px 0 0;
  padding:14px;
  overflow:auto;
}

/* ====== BUTTONS ====== */
.btn{
  height:44px;
  border-radius:14px;
  border:1px solid var(--line);
  background:#101624;
  font-weight:900;
}
.btn.ok{border-color:var(--ok)}
.btn.warn{border-color:var(--warn)}
.btn.danger{border-color:var(--danger)}
</style>
</head>

<body>
<div class="wrap">

  <!-- HEADER -->
  <div class="row between">
    <div>
      <div id="shopName">Î¤Î¿ ÎœÎ±Î³Î±Î¶Î¯</div>
      <div class="sub" id="today"></div>
    </div>
    <div class="row">
      <button class="btn" onclick="openSummary()">ğŸ“Š</button>
      <button class="btn" onclick="openAdmin()">âš™</button>
    </div>
  </div>

  <!-- TABLES VIEW -->
  <div id="viewTables" class="card">
    <div class="tables" id="tables"></div>
  </div>

  <!-- TICKET VIEW -->
  <div id="viewTicket" class="card hidden">
    <div class="row between">
      <button class="btn" onclick="backToTables()">â†</button>
      <div id="ticketTitle"></div>
      <button class="btn warn" onclick="openPay()">Î Î»Î·ÏÏ‰Î¼Î®</button>
    </div>

    <div class="card">
      <div class="sub">Î‘Î½Î¿Î¹Ï‡Ï„Î¬ items</div>
      <div class="ticketLines" id="ticketLines"></div>
    </div>

    <!-- QUICK BAR -->
    <div class="card">
      <div class="sub">Î“ÏÎ®Î³Î¿ÏÎ±</div>
      <div class="quickBar" id="quickBar"></div>
    </div>

    <!-- CATEGORIES -->
    <div class="cats">
      <button class="catBtn active" onclick="setCat('coffee')">â˜•</button>
      <button class="catBtn" onclick="setCat('snack')">ğŸ¥</button>
      <button class="catBtn" onclick="setCat('drink')">ğŸº</button>
      <button class="catBtn" onclick="setCat('other')">ğŸ¥¤</button>
    </div>

    <!-- PRODUCTS -->
    <div class="products" id="products"></div>
  </div>

</div>

<!-- SUMMARY -->
<div class="modal" id="summaryModal">
  <div class="sheet">
    <h3>ğŸ“Š Î£ÏÎ½Î¿ÏˆÎ· Î·Î¼Î­ÏÎ±Ï‚</h3>
    <div id="summaryContent"></div>
    <button class="btn" onclick="closeSummary()">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
  </div>
</div>

<!-- ADMIN -->
<div class="modal" id="adminModal">
  <div class="sheet">
    <h3>âš™ Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚</h3>
    <button class="btn" onclick="setShopName()">Î‘Î»Î»Î±Î³Î® Î¿Î½ÏŒÎ¼Î±Ï„Î¿Ï‚ Î¼Î±Î³Î±Î¶Î¹Î¿Ï</button>
    <button class="btn" onclick="closeAdmin()">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
  </div>
</div>

<script>
/* ================= DATA ================= */
const TABLES = ["T1","T2","T3","T4","T5","T6","T7","T8","BAR","Î•ÎÎ©"];
const PRODUCTS = {
  coffee:[
    ["Espresso",2.6],["Cappuccino",3.6],["Freddo",3.8],["Latte",4.2]
  ],
  snack:[
    ["ÎšÏÎ¿Ï…Î±ÏƒÎ¬Î½",2.8],["Î¤Î¿ÏƒÏ„",4.5],["ÎœÎ¬Ï†Î¹Î½",3.5]
  ],
  drink:[
    ["ÎœÏ€ÏÏÎ±",5.2],["Aperol",8.5],["Gin Tonic",9]
  ],
  other:[
    ["ÎÎµÏÏŒ",2.8],["Coca Cola",3.4]
  ]
};

let state = {
  table:null,
  cat:"coffee",
  tickets: JSON.parse(localStorage.getItem("tickets")||"{}"),
  usage: JSON.parse(localStorage.getItem("usage")||"{}")
};

/* ================= INIT ================= */
document.getElementById("today").innerText =
  new Date().toLocaleDateString("el-GR");

renderTables();

/* ================= TABLES ================= */
function renderTables(){
  const el = document.getElementById("tables");
  el.innerHTML="";
  TABLES.forEach(t=>{
    const btn=document.createElement("button");
    btn.className="tableBtn";
    btn.innerText=t;
    if(state.tickets[t]?.length) btn.classList.add("open");
    else btn.classList.add("clean");
    btn.onclick=()=>openTable(t);
    el.appendChild(btn);
  });
}

function openTable(t){
  state.table=t;
  document.getElementById("viewTables").classList.add("hidden");
  document.getElementById("viewTicket").classList.remove("hidden");
  document.getElementById("ticketTitle").innerText="Î¤ÏÎ±Ï€Î­Î¶Î¹ "+t;
  renderTicket();
  renderQuick();
  renderProducts();
}

function backToTables(){
  state.table=null;
  document.getElementById("viewTicket").classList.add("hidden");
  document.getElementById("viewTables").classList.remove("hidden");
  renderTables();
}

/* ================= TICKET ================= */
function renderTicket(){
  const box=document.getElementById("ticketLines");
  box.innerHTML="";
  (state.tickets[state.table]||[]).forEach(l=>{
    const d=document.createElement("div");
    d.className="line";
    d.innerHTML=`${l[0]} <b>${l[1]}â‚¬</b>`;
    box.appendChild(d);
  });
}

function addItem(name,price){
  if(!state.tickets[state.table]) state.tickets[state.table]=[];
  state.tickets[state.table].push([name,price]);
  state.usage[name]=(state.usage[name]||0)+1;
  localStorage.setItem("tickets",JSON.stringify(state.tickets));
  localStorage.setItem("usage",JSON.stringify(state.usage));
  navigator.vibrate?.(20);
  renderTicket();
  renderQuick();
}

/* ================= QUICK BAR ================= */
function renderQuick(){
  const bar=document.getElementById("quickBar");
  bar.innerHTML="";
  const favs=Object.entries(state.usage)
    .sort((a,b)=>b[1]-a[1])
    .slice(0,8);
  favs.forEach(f=>{
    const btn=document.createElement("button");
    btn.className="quickBtn";
    btn.innerHTML=f[0];
    btn.onclick=()=>addItem(f[0],findPrice(f[0]));
    bar.appendChild(btn);
  });
}

/* ================= PRODUCTS ================= */
function setCat(c){
  state.cat=c;
  document.querySelectorAll(".catBtn").forEach(b=>b.classList.remove("active"));
  event.target.classList.add("active");
  renderProducts();
}

function renderProducts(){
  const box=document.getElementById("products");
  box.innerHTML="";
  PRODUCTS[state.cat].forEach(p=>{
    const btn=document.createElement("button");
    btn.className="prodBtn";
    btn.innerHTML=`${p[0]}<span>${p[1]}â‚¬</span>`;
    btn.onclick=()=>addItem(p[0],p[1]);
    box.appendChild(btn);
  });
}

function findPrice(name){
  for(let c in PRODUCTS){
    for(let p of PRODUCTS[c]) if(p[0]==name) return p[1];
  }
  return 0;
}

/* ================= SUMMARY ================= */
function openSummary(){
  let total=0;
  Object.values(state.tickets).flat().forEach(i=>total+=i[1]);
  document.getElementById("summaryContent").innerHTML=
    "Î£ÏÎ½Î¿Î»Î¿ Î·Î¼Î­ÏÎ±Ï‚: <b>"+total.toFixed(2)+"â‚¬</b>";
  document.getElementById("summaryModal").classList.add("show");
}
function closeSummary(){
  document.getElementById("summaryModal").classList.remove("show");
}

/* ================= ADMIN ================= */
function openAdmin(){
  document.getElementById("adminModal").classList.add("show");
}
function closeAdmin(){
  document.getElementById("adminModal").classList.remove("show");
}
function setShopName(){
  let pin=localStorage.getItem("adminPin");
  if(!pin){
    const p=prompt("ÎŒÏÎ¹ÏƒÎµ Admin PIN");
    if(!p) return;
    localStorage.setItem("adminPin",p);
    pin=p;
  }
  const inPin=prompt("Admin PIN:");
  if(inPin!==pin){alert("Î›Î¬Î¸Î¿Ï‚ PIN");return;}
  const name=prompt("ÎÎ­Î¿ ÏŒÎ½Î¿Î¼Î±:");
  if(name){
    document.getElementById("shopName").innerText=name;
    localStorage.setItem("shopName",name);
  }
}
const savedName=localStorage.getItem("shopName");
if(savedName) document.getElementById("shopName").innerText=savedName;
</script>
</body>
</html>
