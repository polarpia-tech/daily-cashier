<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <meta name="theme-color" content="#0b0f14"/>
  <title>Daily Cashier</title>

  <style>
    :root{
      --bg:#0b0f14;
      --panel:#0f1520;
      --text:#e9eef7;
      --muted:#9fb0c7;
      --line:rgba(255,255,255,.10);
      --line2:rgba(255,255,255,.06);
      --accent:#3aa2ff;
      --ok:#24d18d;
      --warn:#ffb020;
      --danger:#ff5b6e;
      --r:14px;
      --tap:44px;
    }
    html,body{height:100%; width:100%; margin:0; background:var(--bg); color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; overflow-x:hidden;}
    *{box-sizing:border-box; min-width:0;}
    button,input,select{font:inherit; color:inherit;}
    button{touch-action:manipulation;}
    .app{min-height:100%; display:flex; flex-direction:column;}
    .main{flex:1; padding:12px 12px calc(12px + env(safe-area-inset-bottom));}

    /* Views */
    .view{display:none;}
    .view.show{display:block;}

    /* Headers per-view */
    .vhead{
      position:sticky; top:0; z-index:1000;
      padding:10px 12px 8px;
      margin:-12px -12px 12px;
      background:rgba(11,15,20,.92);
      border-bottom:1px solid var(--line2);
      backdrop-filter: blur(10px);
    }
    .hrow{display:flex; align-items:center; justify-content:space-between; gap:10px;}
    .title{font-weight:1000; font-size:18px; line-height:1.1; word-break:break-word;}
    .sub{color:var(--muted); font-size:12.5px; line-height:1.25; white-space:pre-line;}
    .iconbtn{
      width:40px; height:40px; border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      display:grid; place-items:center;
      cursor:pointer;
    }
    .btn{
      height:44px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      padding:0 14px;
      font-weight:900;
      cursor:pointer;
      display:inline-flex; align-items:center; gap:8px;
      white-space:nowrap;
    }
    .btn.primary{border-color:rgba(58,162,255,.55);}
    .btn.ok{border-color:rgba(36,209,141,.55);}
    .btn.danger{border-color:rgba(255,91,110,.55);}

    .select{
      height:40px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      padding:0 12px;
      max-width:54vw;
    }

    /* Big actions (Home) */
    .big{
      width:100%;
      height:58px;
      border-radius:16px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      display:flex; align-items:center; justify-content:space-between;
      padding:0 14px;
      cursor:pointer;
      font-weight:1000;
    }
    .big .meta{color:var(--muted); font-weight:800; font-size:13px;}

    /* Table grid */
    .grid{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:10px;
    }
    @media (min-width:520px){
      .grid{grid-template-columns:repeat(3,minmax(0,1fr));}
    }
    .tcard{
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      border-radius:16px;
      padding:12px;
      cursor:pointer;
      min-height:78px;
      display:flex; flex-direction:column; justify-content:space-between;
    }
    .tname{font-weight:1000; font-size:18px;}
    .tmeta{display:flex; align-items:center; justify-content:space-between; gap:8px; margin-top:8px;}
    .badge{
      display:inline-flex; align-items:center; justify-content:center;
      padding:0 10px; height:22px; border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      font-size:12px; font-weight:900;
      white-space:nowrap;
    }
    .openDot{
      width:10px;height:10px;border-radius:999px;
      background:rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.18);
    }
    .openDot.on{background:rgba(36,209,141,.85); border-color:rgba(36,209,141,.65);}

    /* Ticket layout */
    .sectionTitle{color:var(--muted); font-size:12.5px; margin:12px 2px 8px;}
    .list{border-top:1px solid var(--line2);}
    .row{
      width:100%;
      padding:10px 4px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border-bottom:1px solid var(--line2);
    }
    .leftcol{display:flex; flex-direction:column; gap:4px; min-width:0;}
    .rname{font-weight:1000; line-height:1.15; word-break:break-word;}
    .rsub{color:var(--muted); font-size:12.5px; line-height:1.2;}
    .ctrls{display:flex; align-items:center; gap:8px; flex:0 0 auto;}

    .qty{
      display:flex; align-items:center; gap:6px;
      border:1px solid var(--line);
      border-radius:999px;
      padding:4px;
      background:rgba(255,255,255,.02);
    }
    .qbtn{
      width:28px; height:28px; border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      display:grid; place-items:center;
      cursor:pointer;
      font-weight:1000;
      font-size:16px;
    }
    .qval{min-width:20px; text-align:center; font-weight:1000; font-size:13px;}

    .payicons{display:flex; align-items:center; gap:6px;}
    .pbtn{
      width:28px; height:28px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      display:grid; place-items:center;
      cursor:pointer;
      font-size:14px;
    }
    .pbtn.cash{border-color:rgba(36,209,141,.55);}
    .pbtn.card{border-color:rgba(58,162,255,.55);}
    .pbtn.free{border-color:rgba(255,176,32,.55);}

    /* Chips */
    .chips{
      display:flex; flex-wrap:wrap; gap:8px;
      padding:4px 2px 2px;
    }
    .chip{
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      border-radius:999px;
      padding:8px 10px;
      font-weight:900;
      font-size:12.5px;
      cursor:pointer;
      max-width:100%;
    }

    /* Search */
    .search{
      width:100%;
      height:44px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      padding:0 14px;
      outline:none;
    }

    /* Ticket bottom actions (only in Ticket) */
    .ticketbar{
      position:fixed; left:0; right:0; bottom:0; z-index:1200;
      padding:10px 12px calc(10px + env(safe-area-inset-bottom));
      background:linear-gradient(180deg, transparent, rgba(11,15,20,.78) 22%, rgba(11,15,20,.96));
      border-top:1px solid var(--line2);
      backdrop-filter: blur(10px);
      display:none;
    }
    .ticketbar.show{display:block;}
    .twrap{
      display:grid;
      grid-template-columns:repeat(3,minmax(0,1fr));
      gap:10px;
    }
    .tbtn{
      height:46px; border-radius:16px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      cursor:pointer;
      font-weight:1000;
      width:100%;
      display:flex; align-items:center; justify-content:center;
      gap:8px;
      white-space:nowrap;
      font-size:14px;
    }
    .tbtn.danger{border-color:rgba(255,91,110,.55);}
    .tbtn.primary{border-color:rgba(58,162,255,.55);}

    /* Overlays */
    .overlay{
      position:fixed; inset:0; z-index:3000;
      background:rgba(0,0,0,.55);
      backdrop-filter: blur(4px);
      display:none;
      padding:14px 12px;
    }
    .overlay.show{display:flex; align-items:flex-end; justify-content:center;}
    .sheet{
      width:calc(100vw - 24px);
      max-width:900px;
      max-height:86vh;
      overflow:auto;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(15,20,29,.92);
      padding:12px;
      box-shadow:0 30px 120px rgba(0,0,0,.65);
    }
    .sheethead{display:flex; align-items:center; justify-content:space-between; gap:10px;}
    .sheettitle{font-weight:1000; font-size:16px;}
    .hr{height:1px; background:var(--line2); margin:10px 0;}
    .sheetbtnrow{display:flex; gap:10px; flex-wrap:wrap;}
    .sheetbtn{
      height:42px; border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      padding:0 14px;
      cursor:pointer;
      font-weight:1000;
    }
    .sheetbtn.danger{border-color:rgba(255,91,110,.55);}
    .sheetbtn.ok{border-color:rgba(36,209,141,.55);}
    .sheetbtn.primary{border-color:rgba(58,162,255,.55);}

    /* Toast */
    .toast{
      position:fixed;
      left:50%;
      transform:translateX(-50%);
      bottom:calc(18px + env(safe-area-inset-bottom));
      z-index:5000;
      background:rgba(20,28,40,.92);
      border:1px solid rgba(255,255,255,.12);
      border-radius:14px;
      padding:10px 12px;
      display:none;
      max-width:calc(100vw - 24px);
    }
    .toast.show{display:block;}
    .toast .t{font-weight:1000;}
    .toast .s{color:var(--muted); font-size:12.5px; margin-top:4px; line-height:1.2;}

    /* PIN Modal */
    .pinBox{
      width:calc(100vw - 24px);
      max-width:420px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(15,20,29,.96);
      padding:14px;
      box-shadow:0 30px 120px rgba(0,0,0,.65);
    }
    .pinTitle{font-weight:1000; font-size:16px;}
    .pinSub{color:var(--muted); font-size:12.5px; margin-top:6px; white-space:pre-line;}
    .pinInput{
      margin-top:12px;
      width:100%;
      height:52px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      padding:0 14px;
      outline:none;
      font-size:22px;
      letter-spacing:10px;
      text-align:center;
    }

    /* Screensaver */
    .screensaver{
      position:fixed; inset:0; z-index:9999;
      display:none;
      background:#000;
      color:#fff;
      padding:24px;
    }
    .screensaver.show{display:flex; align-items:center; justify-content:center;}
    .ssCenter{text-align:center; max-width:92vw;}
    .ssLogo{
      font-weight:1000;
      font-size:40px;
      letter-spacing:.8px;
      line-height:1.1;
      word-break:break-word;
    }
    .ssUser{
      margin-top:16px;
      font-size:16px;
      opacity:.85;
      letter-spacing:.2px;
    }
    .ssHint{
      margin-top:26px;
      font-size:12.5px;
      opacity:.55;
    }
  </style>
</head>

<body>
<div class="app">
  <div class="main">

    <!-- HOME -->
    <div id="viewHome" class="view show">
      <div class="vhead">
        <div class="hrow">
          <div style="min-width:0;">
            <div class="title" id="shopName">â€”</div>
            <div class="sub" id="homeSub">â€”</div>
          </div>
          <div style="display:flex;align-items:center;gap:8px;">
            <select id="userSelect" class="select"></select>
            <button class="iconbtn" id="btnSettings" title="Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚">âš™ï¸</button>
          </div>
        </div>
      </div>

      <button class="big" id="btnNewOrder"><span>â• ÎÎ­Î± Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±</span><span class="meta">Î”Î¹Î¬Î»ÎµÎ¾Îµ Ï„ÏÎ±Ï€Î­Î¶Î¹</span></button>
      <div style="height:10px;"></div>
      <button class="big" id="btnOpenOrders"><span>ğŸ“„ Î‘Î½Î¿Î¹Ï‡Ï„Î¬</span><span class="meta" id="openCountMeta">0</span></button>
      <div style="height:10px;"></div>
      <button class="big" id="btnSummaryHome"><span>ğŸ“Š Î£ÏÎ½Î¿ÏˆÎ·</span><span class="meta">Î—Î¼Î­ÏÎ±Ï‚</span></button>

      <div style="height:12px;"></div>
      <div class="sub" id="homeStats">â€”</div>
    </div>

    <!-- TABLES -->
    <div id="viewTables" class="view">
      <div class="vhead">
        <div class="hrow">
          <button class="btn" id="btnBackHome">â† Home</button>
          <div style="min-width:0;">
            <div class="title">Î¤ÏÎ±Ï€Î­Î¶Î¹Î±</div>
            <div class="sub" id="tablesSub">â€”</div>
          </div>
          <button class="btn primary" id="btnToggleTables">ÎœÏŒÎ½Î¿ Î±Î½Î¿Î¹Ï‡Ï„Î¬</button>
        </div>
      </div>

      <div id="tablesGrid" class="grid"></div>
    </div>

    <!-- TICKET -->
    <div id="viewTicket" class="view">
      <div class="vhead">
        <div class="hrow">
          <button class="btn" id="btnBackTables">â† Î¤ÏÎ±Ï€Î­Î¶Î¹Î±</button>
          <div style="min-width:0;">
            <div class="title" id="ticketTitle">â€”</div>
            <div class="sub" id="ticketSub">â€”</div>
          </div>
          <button class="btn ok" id="btnPay">Î Î»Î·ÏÏ‰Î¼Î®</button>
        </div>
      </div>

      <div class="sectionTitle" id="openTitle">Î‘Î½Î¿Î¹Ï‡Ï„Î¬ items</div>
      <div id="openItemsList" class="list"></div>

      <div class="sectionTitle">Top 8 ÏƒÎ®Î¼ÎµÏÎ±</div>
      <div class="chips" id="top8Row"></div>

      <div class="sectionTitle">ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚</div>
      <div class="chips" id="catChips"></div>

      <div style="height:8px;"></div>
      <input id="prodSearch" class="search" placeholder="ğŸ” Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚..." />

      <div class="sectionTitle" id="prodTitle">Î ÏÎ¿ÏŠÏŒÎ½Ï„Î±</div>
      <div id="productsList" class="list"></div>
    </div>
  </div>

  <!-- Ticket-only bottom bar -->
  <div class="ticketbar" id="ticketBar">
    <div class="twrap">
      <button class="tbtn" id="btnUndo">â†© Undo</button>
      <button class="tbtn primary" id="btnCSV">CSV</button>
      <button class="tbtn danger" id="btnWipe">Î”Î¹Î±Î³ÏÎ±Ï†Î®</button>
    </div>
  </div>
</div>

<!-- Settings overlay -->
<div class="overlay" id="settingsOv">
  <div class="sheet">
    <div class="sheethead">
      <div class="sheettitle">âš™ï¸ Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚</div>
      <button class="sheetbtn" id="btnCloseSettings">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
    </div>
    <div class="hr"></div>
    <div class="sub" id="settingsSub">â€”</div>
    <div class="hr"></div>
    <div class="sheetbtnrow">
      <button class="sheetbtn" id="btnAddUser">+ Î§ÏÎ®ÏƒÏ„Î·Ï‚</button>
      <button class="sheetbtn" id="btnRenameUser">âœï¸ ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î±</button>
      <button class="sheetbtn" id="btnSetPin">ğŸ”’ PIN Ï‡ÏÎ®ÏƒÏ„Î·</button>
      <button class="sheetbtn" id="btnShopName">ğŸ· ÎŒÎ½Î¿Î¼Î± Î¼Î±Î³Î±Î¶Î¹Î¿Ï</button>
      <button class="sheetbtn danger" id="btnDelUser">ğŸ—‘ Î”Î¹Î±Î³ÏÎ±Ï†Î® Ï‡ÏÎ®ÏƒÏ„Î·</button>
    </div>
  </div>
</div>

<!-- Summary overlay -->
<div class="overlay" id="summaryOv">
  <div class="sheet">
    <div class="sheethead">
      <div class="sheettitle">ğŸ“Š Î£ÏÎ½Î¿ÏˆÎ· Î·Î¼Î­ÏÎ±Ï‚</div>
      <button class="sheetbtn" id="btnCloseSummary">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
    </div>
    <div class="hr"></div>
    <div class="sub" id="summaryText">â€”</div>
    <div class="hr"></div>
    <div class="sub" style="margin-bottom:6px;">Top Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î±</div>
    <div id="topList"></div>
    <div class="hr"></div>
    <div class="sub" style="margin-bottom:6px;">Î‘Î½Î¬ Ï‡ÏÎ®ÏƒÏ„Î· (Ï€Î¬Ï„Î± Î³Î¹Î± Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚)</div>
    <div id="userSumList"></div>
  </div>
</div>

<!-- User details overlay -->
<div class="overlay" id="userOv">
  <div class="sheet">
    <div class="sheethead">
      <div class="sheettitle" id="userTitle">â€”</div>
      <button class="sheetbtn" id="btnCloseUser">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
    </div>
    <div class="hr"></div>
    <div class="sub" id="userSub">â€”</div>
    <div class="hr"></div>
    <div id="userBody"></div>
  </div>
</div>

<!-- Pay overlay -->
<div class="overlay" id="payOv">
  <div class="sheet">
    <div class="sheethead">
      <div class="sheettitle" id="payTitle">Î Î»Î·ÏÏ‰Î¼Î®</div>
      <button class="sheetbtn" id="btnClosePay">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
    </div>
    <div class="hr"></div>
    <div class="sub">Î•Ï€Î¯Î»ÎµÎ¾Îµ items (split) ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ Ï„ÏÏŒÏ€Î¿ Ï€Î»Î·ÏÏ‰Î¼Î®Ï‚.</div>
    <div class="hr"></div>
    <div id="payList"></div>
    <div class="hr"></div>
    <div class="sub" id="payTotal">Î¤ÎµÎ»Î¹ÎºÏŒ: 0,00 â‚¬</div>
    <div style="height:10px;"></div>
    <div class="sheetbtnrow">
      <button class="sheetbtn ok" id="btnPayCash">ğŸ’¶ ÎœÎµÏ„ÏÎ·Ï„Î¬</button>
      <button class="sheetbtn primary" id="btnPayCard">ğŸ’³ ÎšÎ¬ÏÏ„Î±</button>
      <button class="sheetbtn" style="border-color:rgba(255,176,32,.55)" id="btnPayFree">ğŸ ÎšÎµÏÎ±ÏƒÎ¼Î­Î½Î±</button>
      <button class="sheetbtn" id="btnSelAll">Î•Ï€Î¯Î»ÎµÎ¾Îµ ÏŒÎ»Î±</button>
    </div>
  </div>
</div>

<!-- QuickPay overlay -->
<div class="overlay" id="qpayOv">
  <div class="sheet">
    <div class="sheethead">
      <div class="sheettitle" id="qpayTitle">â€”</div>
      <button class="sheetbtn" id="btnCloseQPay">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
    </div>
    <div class="hr"></div>
    <div class="sub" id="qpaySub">â€”</div>
    <div class="hr"></div>
    <div class="sheetbtnrow" id="qpayBtns"></div>
  </div>
</div>

<!-- PIN Overlay -->
<div class="overlay" id="pinOv" style="align-items:center;">
  <div class="pinBox">
    <div class="sheethead">
      <div class="pinTitle" id="pinTitle">PIN</div>
      <button class="sheetbtn" id="pinCancel">Î†ÎºÏ…ÏÎ¿</button>
    </div>
    <div class="pinSub" id="pinSub">â€”</div>
    <input
      class="pinInput"
      id="pinInput"
      type="password"
      inputmode="numeric"
      pattern="[0-9]*"
      maxlength="4"
      autocomplete="one-time-code"
      placeholder="â€¢â€¢â€¢â€¢"
    />
    <div class="hr"></div>
    <div class="sheetbtnrow" style="justify-content:flex-end;">
      <button class="sheetbtn primary" id="pinOk">ÎŸÎš</button>
    </div>
  </div>
</div>

<!-- Screensaver -->
<div class="screensaver" id="ss">
  <div class="ssCenter">
    <div class="ssLogo" id="ssLogo">â€”</div>
    <div class="ssUser" id="ssUser">â€”</div>
    <div class="ssHint">Î Î¬Ï„Î·ÏƒÎµ Î¿Ï€Î¿Ï…Î´Î®Ï€Î¿Ï„Îµ Î³Î¹Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ¿Ï†Î®</div>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast">
  <div class="t" id="toastT">â€”</div>
  <div class="s" id="toastS">â€”</div>
</div>

<script src="./app.js?v=1"></script>
<script defer src="./app.js?v=999"></script>
</body>
</html>